{"version":3,"sources":["webpack:///src/app/login/form/form.page.html","webpack:///src/app/login/form/form.page.scss","webpack:///src/app/login/form/form.page.ts","webpack:///src/app/login/login-routing.module.ts","webpack:///src/app/login/login.module.ts"],"names":["FormPage","loginService","router","storage","usersService","menuController","loadingController","imageUrl","imageId","myForm","email","required","password","controls","setValue","formData","FormData","enable","controlName","validationType","control","result","hasError","dirty","touched","invalid","Object","keys","forEach","markAsTouched","body","value","create","message","loading","present","run","toPromise","then","res","json","get","deviceToken","set","user","active","id","name","roles","city","phone","serviceDescription","profilePicture","append","Blob","JSON","stringify","type","updateUser","token","err","error","parse","_body","dismiss","update","navigate","selector","template","routes","path","component","LoginRoutingModule","imports","forChild","exports","LoginModule","forRoot","declarations","providers"],"mappings":"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","file":"login-login-module-es5.js","sourcesContent":["export default \"<ion-content>\\r\\n  <div id=\\\"container\\\">\\r\\n    <ion-grid>\\r\\n      <ion-row>\\r\\n        <ion-col class=\\\"ion-align-self-center\\\" col-8 offset=\\\"2\\\">\\r\\n          <img src=\\\"../../../assets/logo/otoro.png\\\" width=\\\"70%\\\" height=\\\"auto\\\" />\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n      <ion-row>\\r\\n        <ion-col col-12>\\r\\n          <h4 class=\\\"no-margin-bottom\\\">Iniciar sesi&oacute;n</h4>\\r\\n          <small>Es genial verte de nuevo</small>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n      <ion-row id=\\\"form-container\\\">\\r\\n        <ion-col col-12>\\r\\n          <form [formGroup]=\\\"myForm\\\">\\r\\n            <div class=\\\"form-group\\\">\\r\\n              <label class=\\\"bold\\\">Correo electrónico</label>\\r\\n              <input\\r\\n                type=\\\"text\\\"\\r\\n                class=\\\"form-control width-100\\\"\\r\\n                [class.error-input]=\\\"controlHasError('email', 'required')\\\"\\r\\n                formControlName=\\\"email\\\"\\r\\n              />\\r\\n              <span\\r\\n                class=\\\"error-input-label\\\"\\r\\n                *ngIf=\\\"controlHasError('email', 'required')\\\"\\r\\n              >\\r\\n                <strong class=\\\"error\\\">Campo requerido</strong>\\r\\n              </span>\\r\\n            </div>\\r\\n            <div class=\\\"form-group\\\">\\r\\n              <label class=\\\"bold\\\">Contraseña</label>\\r\\n              <input\\r\\n                type=\\\"password\\\"\\r\\n                class=\\\"form-control width-100\\\"\\r\\n                [class.error-input]=\\\"controlHasError('password', 'required')\\\"\\r\\n                formControlName=\\\"password\\\"\\r\\n              />\\r\\n              <span\\r\\n                class=\\\"error-input-label\\\"\\r\\n                *ngIf=\\\"controlHasError('password', 'required')\\\"\\r\\n              >\\r\\n                <strong class=\\\"error\\\">Campo requerido</strong>\\r\\n              </span>\\r\\n            </div>\\r\\n            <div class=\\\"display-flex\\\" id=\\\"btn-container\\\">\\r\\n              <ion-button\\r\\n                color=\\\"primary\\\"\\r\\n                (click)=\\\"login()\\\"\\r\\n                class=\\\"margin-center\\\"\\r\\n              >\\r\\n                Ingresar\\r\\n              </ion-button>\\r\\n            </div>\\r\\n          </form>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n      <ion-row>\\r\\n        <ion-col col-6>\\r\\n          <small (click)=\\\"goToRecoverPassword()\\\"\\r\\n            >Olvid&eacute; mi contrase&ntilde;a</small\\r\\n          >\\r\\n        </ion-col>\\r\\n        <ion-col col-6 class=\\\"align-text-right\\\">\\r\\n          <small (click)=\\\"goToRegistration()\\\">Registrarme</small>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n    </ion-grid>\\r\\n  </div>\\r\\n</ion-content>\\r\\n\";","export default \"#btn-container,\\n#form-container {\\n  margin-top: 5%;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbG9naW4vZm9ybS9DOlxcVXNlcnNcXGluZ2RtXFxwcm9qZWN0c1xcb3Rvcm9cXGZyb250L3NyY1xcYXBwXFxsb2dpblxcZm9ybVxcZm9ybS5wYWdlLnNjc3MiLCJzcmMvYXBwL2xvZ2luL2Zvcm0vZm9ybS5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0VBRUUsY0FBYztBQ0NoQiIsImZpbGUiOiJzcmMvYXBwL2xvZ2luL2Zvcm0vZm9ybS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjYnRuLWNvbnRhaW5lcixcclxuI2Zvcm0tY29udGFpbmVyIHtcclxuICBtYXJnaW4tdG9wOiA1JTtcclxufVxyXG4iLCIjYnRuLWNvbnRhaW5lcixcbiNmb3JtLWNvbnRhaW5lciB7XG4gIG1hcmdpbi10b3A6IDUlO1xufVxuIl19 */\";","import { Component, OnInit } from \"@angular/core\";\r\nimport { FormGroup, FormControl, Validators } from \"@angular/forms\";\r\nimport { Router } from \"@angular/router\";\r\nimport { Storage } from \"@ionic/storage\";\r\nimport { LoginService } from \"./login.service\";\r\nimport { UsersService } from \"src/app/users/users.service\";\r\nimport { MenuController, LoadingController } from \"@ionic/angular\";\r\n\r\n@Component({\r\n  selector: \"app-form\",\r\n  templateUrl: \"./form.page.html\",\r\n  styleUrls: [\"./form.page.scss\"],\r\n})\r\nexport class FormPage implements OnInit {\r\n  private loading: any;\r\n  private formData: FormData;\r\n  public imageId: string;\r\n  public imageUrl: string;\r\n  public myForm: FormGroup;\r\n  constructor(\r\n    private loginService: LoginService,\r\n    private router: Router,\r\n    public storage: Storage,\r\n    private usersService: UsersService,\r\n    private menuController: MenuController,\r\n    private loadingController: LoadingController\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.imageUrl = \"../../assets/logo/otoro-logo.png\";\r\n    this.imageId = \"top-image\";\r\n    this.myForm = new FormGroup({\r\n      email: new FormControl(\"email\", [Validators.required]),\r\n      password: new FormControl(\"password\", [Validators.required]),\r\n    });\r\n\r\n    this.myForm.controls[\"email\"].setValue(null);\r\n    this.myForm.controls[\"password\"].setValue(null);\r\n    this.formData = new FormData();\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    this.menuController.enable(false);\r\n  }\r\n\r\n  public controlHasError(controlName: string, validationType: string): boolean {\r\n    const control = this.myForm.controls[controlName];\r\n    if (!control) {\r\n      return false;\r\n    }\r\n\r\n    const result =\r\n      control.hasError(validationType) && (control.dirty || control.touched);\r\n\r\n    return result;\r\n  }\r\n\r\n  async login() {\r\n    let controls = this.myForm.controls;\r\n    if (this.myForm.invalid) {\r\n      Object.keys(controls).forEach((controlName) =>\r\n        controls[controlName].markAsTouched()\r\n      );\r\n      return;\r\n    }\r\n\r\n    const body = {\r\n      email: controls[\"email\"].value,\r\n      password: controls[\"password\"].value,\r\n    };\r\n\r\n    this.loading = await this.loadingController.create({\r\n      message: \"Cargando...\",\r\n    });\r\n\r\n    await this.loading.present();\r\n    this.loginService\r\n      .run(body)\r\n      .toPromise()\r\n      .then(\r\n        async (res) => {\r\n          let result = res.json();\r\n          let deviceToken = await this.storage.get(\"deviceToken\");\r\n          this.storage.set(\"auth\", result);\r\n          let user = {\r\n            active: result.active,\r\n            deviceToken: deviceToken,\r\n            email: result.email,\r\n            id: result.id,\r\n            name: result.name,\r\n            roles: result.roles,\r\n            city: result.city,\r\n            phone: result.phone,\r\n            serviceDescription: result.serviceDescription,\r\n            profilePicture: result.profilePicture,\r\n          };\r\n          this.formData.append(\r\n            \"userCommand\",\r\n            new Blob([JSON.stringify(user)], {\r\n              type: \"application/json\",\r\n            })\r\n          );\r\n          this.updateUser(result.token);\r\n        },\r\n        async (err) => {\r\n          let error = JSON.parse(err._body);\r\n          await this.loading.dismiss();\r\n        }\r\n      );\r\n  }\r\n\r\n  updateUser(token: string) {\r\n    this.usersService\r\n      .update(this.formData, token)\r\n      .toPromise()\r\n      .then(\r\n        async (res) => {\r\n          this.menuController.enable(true);\r\n          await this.loading.dismiss();\r\n          this.router.navigate([\"/dashboard\"]);\r\n        },\r\n        async (err) => {\r\n          let error = JSON.parse(err._body);\r\n          await this.loading.dismiss();\r\n        }\r\n      );\r\n  }\r\n\r\n  goToRecoverPassword() {\r\n    this.router.navigate([\"/users/recover-password\"]);\r\n  }\r\n\r\n  goToRegistration() {\r\n    this.router.navigate([\"/users/register\"]);\r\n  }\r\n}\r\n","import { NgModule } from \"@angular/core\";\r\nimport { Routes, RouterModule } from \"@angular/router\";\r\nimport { FormPage } from \"./form/form.page\";\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: \"\",\r\n    component: FormPage,\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class LoginRoutingModule {}\r\n","import { NgModule } from \"@angular/core\";\r\nimport { CommonModule } from \"@angular/common\";\r\nimport { HttpClient, HttpClientModule } from \"@angular/common/http\";\r\nimport { FormsModule, ReactiveFormsModule } from \"@angular/forms\";\r\nimport { LoginRoutingModule } from \"./login-routing.module\";\r\nimport { SharedModule } from \"../shared/shared.module\";\r\nimport { IonicModule } from \"@ionic/angular\";\r\nimport { FormPage } from \"./form/form.page\";\r\nimport { DashboardPageModule } from \"../dashboard/dashboard.module\";\r\nimport { HTTP } from \"@ionic-native/http/ngx\";\r\nimport { IonicStorageModule } from '@ionic/storage';\r\n\r\n@NgModule({\r\n  imports: [\r\n    FormsModule,\r\n    HttpClientModule,\r\n    LoginRoutingModule,\r\n    IonicModule,\r\n    ReactiveFormsModule,\r\n    CommonModule,\r\n    SharedModule,\r\n    DashboardPageModule,\r\n    IonicStorageModule.forRoot(),\r\n  ],\r\n  declarations: [FormPage],\r\n  providers: [HTTP],\r\n})\r\nexport class LoginModule {}\r\n"]}