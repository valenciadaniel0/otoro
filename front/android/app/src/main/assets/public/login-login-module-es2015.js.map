{"version":3,"sources":["./src/app/login/form/form.page.html","./src/app/login/form/form.page.scss","./src/app/login/form/form.page.ts","./src/app/login/login-routing.module.ts","./src/app/login/login.module.ts"],"names":[],"mappings":"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","file":"login-login-module-es2015.js","sourcesContent":["export default \"<ion-content>\\r\\n  <div id=\\\"container\\\">\\r\\n    <ion-grid>\\r\\n      <ion-row>\\r\\n        <ion-col class=\\\"ion-align-self-center\\\" col-8 offset=\\\"2\\\">\\r\\n          <img src=\\\"../../../assets/logo/otoro.png\\\" width=\\\"70%\\\" height=\\\"auto\\\" />\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n      <ion-row>\\r\\n        <ion-col col-12>\\r\\n          <h4 class=\\\"no-margin-bottom\\\">Iniciar sesi&oacute;n</h4>\\r\\n          <small>Es genial verte de nuevo</small>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n      <ion-row id=\\\"form-container\\\">\\r\\n        <ion-col col-12>\\r\\n          <form [formGroup]=\\\"myForm\\\">\\r\\n            <div class=\\\"form-group\\\">\\r\\n              <label class=\\\"bold\\\">Correo electrónico</label>\\r\\n              <input\\r\\n                type=\\\"text\\\"\\r\\n                class=\\\"form-control width-100\\\"\\r\\n                [class.error-input]=\\\"controlHasError('email', 'required')\\\"\\r\\n                formControlName=\\\"email\\\"\\r\\n              />\\r\\n              <span\\r\\n                class=\\\"error-input-label\\\"\\r\\n                *ngIf=\\\"controlHasError('email', 'required')\\\"\\r\\n              >\\r\\n                <strong class=\\\"error\\\">Campo requerido</strong>\\r\\n              </span>\\r\\n            </div>\\r\\n            <div class=\\\"form-group\\\">\\r\\n              <label class=\\\"bold\\\">Contraseña</label>\\r\\n              <input\\r\\n                type=\\\"password\\\"\\r\\n                class=\\\"form-control width-100\\\"\\r\\n                [class.error-input]=\\\"controlHasError('password', 'required')\\\"\\r\\n                formControlName=\\\"password\\\"\\r\\n              />\\r\\n              <span\\r\\n                class=\\\"error-input-label\\\"\\r\\n                *ngIf=\\\"controlHasError('password', 'required')\\\"\\r\\n              >\\r\\n                <strong class=\\\"error\\\">Campo requerido</strong>\\r\\n              </span>\\r\\n            </div>\\r\\n            <div class=\\\"display-flex\\\" id=\\\"btn-container\\\">\\r\\n              <ion-button\\r\\n                color=\\\"primary\\\"\\r\\n                (click)=\\\"login()\\\"\\r\\n                class=\\\"margin-center\\\"\\r\\n              >\\r\\n                Ingresar\\r\\n              </ion-button>\\r\\n            </div>\\r\\n          </form>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n      <ion-row>\\r\\n        <ion-col col-6>\\r\\n          <small (click)=\\\"goToRecoverPassword()\\\"\\r\\n            >Olvid&eacute; mi contrase&ntilde;a</small\\r\\n          >\\r\\n        </ion-col>\\r\\n        <ion-col col-6 class=\\\"align-text-right\\\">\\r\\n          <small (click)=\\\"goToRegistration()\\\">Registrarme</small>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n    </ion-grid>\\r\\n  </div>\\r\\n</ion-content>\\r\\n\";","export default \"#btn-container,\\n#form-container {\\n  margin-top: 5%;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbG9naW4vZm9ybS9DOlxcVXNlcnNcXGluZ2RtXFxwcm9qZWN0c1xcb3Rvcm9cXGZyb250L3NyY1xcYXBwXFxsb2dpblxcZm9ybVxcZm9ybS5wYWdlLnNjc3MiLCJzcmMvYXBwL2xvZ2luL2Zvcm0vZm9ybS5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0VBRUUsY0FBYztBQ0NoQiIsImZpbGUiOiJzcmMvYXBwL2xvZ2luL2Zvcm0vZm9ybS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjYnRuLWNvbnRhaW5lcixcclxuI2Zvcm0tY29udGFpbmVyIHtcclxuICBtYXJnaW4tdG9wOiA1JTtcclxufVxyXG4iLCIjYnRuLWNvbnRhaW5lcixcbiNmb3JtLWNvbnRhaW5lciB7XG4gIG1hcmdpbi10b3A6IDUlO1xufVxuIl19 */\";","import { Component, OnInit } from \"@angular/core\";\r\nimport { FormGroup, FormControl, Validators } from \"@angular/forms\";\r\nimport { Router } from \"@angular/router\";\r\nimport { Storage } from \"@ionic/storage\";\r\nimport { LoginService } from \"./login.service\";\r\nimport { UsersService } from \"src/app/users/users.service\";\r\nimport { MenuController, LoadingController } from \"@ionic/angular\";\r\n\r\n@Component({\r\n  selector: \"app-form\",\r\n  templateUrl: \"./form.page.html\",\r\n  styleUrls: [\"./form.page.scss\"],\r\n})\r\nexport class FormPage implements OnInit {\r\n  private loading: any;\r\n  private formData: FormData;\r\n  public imageId: string;\r\n  public imageUrl: string;\r\n  public myForm: FormGroup;\r\n  constructor(\r\n    private loginService: LoginService,\r\n    private router: Router,\r\n    public storage: Storage,\r\n    private usersService: UsersService,\r\n    private menuController: MenuController,\r\n    private loadingController: LoadingController\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.imageUrl = \"../../assets/logo/otoro-logo.png\";\r\n    this.imageId = \"top-image\";\r\n    this.myForm = new FormGroup({\r\n      email: new FormControl(\"email\", [Validators.required]),\r\n      password: new FormControl(\"password\", [Validators.required]),\r\n    });\r\n\r\n    this.myForm.controls[\"email\"].setValue(null);\r\n    this.myForm.controls[\"password\"].setValue(null);\r\n    this.formData = new FormData();\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    this.menuController.enable(false);\r\n  }\r\n\r\n  public controlHasError(controlName: string, validationType: string): boolean {\r\n    const control = this.myForm.controls[controlName];\r\n    if (!control) {\r\n      return false;\r\n    }\r\n\r\n    const result =\r\n      control.hasError(validationType) && (control.dirty || control.touched);\r\n\r\n    return result;\r\n  }\r\n\r\n  async login() {\r\n    let controls = this.myForm.controls;\r\n    if (this.myForm.invalid) {\r\n      Object.keys(controls).forEach((controlName) =>\r\n        controls[controlName].markAsTouched()\r\n      );\r\n      return;\r\n    }\r\n\r\n    const body = {\r\n      email: controls[\"email\"].value,\r\n      password: controls[\"password\"].value,\r\n    };\r\n\r\n    this.loading = await this.loadingController.create({\r\n      message: \"Cargando...\",\r\n    });\r\n\r\n    await this.loading.present();\r\n    this.loginService\r\n      .run(body)\r\n      .toPromise()\r\n      .then(\r\n        async (res) => {\r\n          let result = res.json();\r\n          let deviceToken = await this.storage.get(\"deviceToken\");\r\n          this.storage.set(\"auth\", result);\r\n          let user = {\r\n            active: result.active,\r\n            deviceToken: deviceToken,\r\n            email: result.email,\r\n            id: result.id,\r\n            name: result.name,\r\n            roles: result.roles,\r\n            city: result.city,\r\n            phone: result.phone,\r\n            serviceDescription: result.serviceDescription,\r\n            profilePicture: result.profilePicture,\r\n          };\r\n          this.formData.append(\r\n            \"userCommand\",\r\n            new Blob([JSON.stringify(user)], {\r\n              type: \"application/json\",\r\n            })\r\n          );\r\n          this.updateUser(result.token);\r\n        },\r\n        async (err) => {\r\n          let error = JSON.parse(err._body);\r\n          await this.loading.dismiss();\r\n        }\r\n      );\r\n  }\r\n\r\n  updateUser(token: string) {\r\n    this.usersService\r\n      .update(this.formData, token)\r\n      .toPromise()\r\n      .then(\r\n        async (res) => {\r\n          this.menuController.enable(true);\r\n          await this.loading.dismiss();\r\n          this.router.navigate([\"/dashboard\"]);\r\n        },\r\n        async (err) => {\r\n          let error = JSON.parse(err._body);\r\n          await this.loading.dismiss();\r\n        }\r\n      );\r\n  }\r\n\r\n  goToRecoverPassword() {\r\n    this.router.navigate([\"/users/recover-password\"]);\r\n  }\r\n\r\n  goToRegistration() {\r\n    this.router.navigate([\"/users/register\"]);\r\n  }\r\n}\r\n","import { NgModule } from \"@angular/core\";\r\nimport { Routes, RouterModule } from \"@angular/router\";\r\nimport { FormPage } from \"./form/form.page\";\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: \"\",\r\n    component: FormPage,\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class LoginRoutingModule {}\r\n","import { NgModule } from \"@angular/core\";\r\nimport { CommonModule } from \"@angular/common\";\r\nimport { HttpClient, HttpClientModule } from \"@angular/common/http\";\r\nimport { FormsModule, ReactiveFormsModule } from \"@angular/forms\";\r\nimport { LoginRoutingModule } from \"./login-routing.module\";\r\nimport { SharedModule } from \"../shared/shared.module\";\r\nimport { IonicModule } from \"@ionic/angular\";\r\nimport { FormPage } from \"./form/form.page\";\r\nimport { DashboardPageModule } from \"../dashboard/dashboard.module\";\r\nimport { HTTP } from \"@ionic-native/http/ngx\";\r\nimport { IonicStorageModule } from '@ionic/storage';\r\n\r\n@NgModule({\r\n  imports: [\r\n    FormsModule,\r\n    HttpClientModule,\r\n    LoginRoutingModule,\r\n    IonicModule,\r\n    ReactiveFormsModule,\r\n    CommonModule,\r\n    SharedModule,\r\n    DashboardPageModule,\r\n    IonicStorageModule.forRoot(),\r\n  ],\r\n  declarations: [FormPage],\r\n  providers: [HTTP],\r\n})\r\nexport class LoginModule {}\r\n"],"sourceRoot":"webpack:///"}