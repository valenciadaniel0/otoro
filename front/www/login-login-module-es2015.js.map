{"version":3,"sources":["./src/app/login/form/form.page.html","./src/app/login/form/form.page.scss","./src/app/login/form/form.page.ts","./src/app/login/form/login.service.ts","./src/app/login/login-routing.module.ts","./src/app/login/login.module.ts"],"names":[],"mappings":"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","file":"login-login-module-es2015.js","sourcesContent":["export default \"<ion-content>\\r\\n  <div id=\\\"container\\\">\\r\\n    <ion-grid>\\r\\n      <ion-row>\\r\\n        <ion-col class=\\\"ion-align-self-center\\\" col-8 offset=\\\"2\\\">\\r\\n          <img src=\\\"../../../assets/logo/otoro.png\\\" width=\\\"70%\\\" height=\\\"auto\\\" />\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n      <ion-row>\\r\\n        <ion-col col-12>\\r\\n          <h4 class=\\\"no-margin-bottom\\\">Iniciar sesi&oacute;n</h4>\\r\\n          <small>Es genial verte de nuevo</small>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n      <ion-row id=\\\"form-container\\\">\\r\\n        <ion-col col-12>\\r\\n          <form [formGroup]=\\\"myForm\\\">\\r\\n            <div class=\\\"form-group\\\">\\r\\n              <label class=\\\"bold\\\">Correo electrónico</label>\\r\\n              <input\\r\\n                type=\\\"text\\\"\\r\\n                class=\\\"form-control width-100\\\"\\r\\n                formControlName=\\\"email\\\"\\r\\n              />\\r\\n              <span *ngIf=\\\"controlHasError('email', 'required')\\\">\\r\\n                <strong class=\\\"error\\\">Campo requerido</strong>\\r\\n              </span>\\r\\n            </div>\\r\\n            <div class=\\\"form-group\\\">\\r\\n              <label class=\\\"bold\\\">Contraseña</label>\\r\\n              <input\\r\\n                type=\\\"password\\\"\\r\\n                class=\\\"form-control width-100\\\"\\r\\n                formControlName=\\\"password\\\"\\r\\n              />\\r\\n              <span *ngIf=\\\"controlHasError('password', 'required')\\\">\\r\\n                <strong class=\\\"error\\\">Campo requerido</strong>\\r\\n              </span>\\r\\n            </div>\\r\\n            <div class=\\\"display-flex\\\" id=\\\"btn-container\\\">\\r\\n              <ion-button\\r\\n                color=\\\"primary\\\"\\r\\n                (click)=\\\"login()\\\"\\r\\n                class=\\\"margin-center\\\"\\r\\n              >\\r\\n                Ingresar\\r\\n              </ion-button>\\r\\n            </div>\\r\\n          </form>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n      <ion-row>\\r\\n        <ion-col col-6>\\r\\n          <small>Olvid&eacute; mi contrase&ntilde;a</small>\\r\\n        </ion-col>\\r\\n        <ion-col col-6 class=\\\"align-text-right\\\">\\r\\n          <small>Registrarme</small>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n    </ion-grid>\\r\\n  </div>\\r\\n</ion-content>\\r\\n\";","export default \"#btn-container,\\n#form-container {\\n  margin-top: 5%;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbG9naW4vZm9ybS9DOlxcVXNlcnNcXGluZ2RtXFxwcm9qZWN0c1xcb3Rvcm9cXGZyb250L3NyY1xcYXBwXFxsb2dpblxcZm9ybVxcZm9ybS5wYWdlLnNjc3MiLCJzcmMvYXBwL2xvZ2luL2Zvcm0vZm9ybS5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0VBRUUsY0FBYztBQ0NoQiIsImZpbGUiOiJzcmMvYXBwL2xvZ2luL2Zvcm0vZm9ybS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjYnRuLWNvbnRhaW5lcixcclxuI2Zvcm0tY29udGFpbmVyIHtcclxuICBtYXJnaW4tdG9wOiA1JTtcclxufVxyXG4iLCIjYnRuLWNvbnRhaW5lcixcbiNmb3JtLWNvbnRhaW5lciB7XG4gIG1hcmdpbi10b3A6IDUlO1xufVxuIl19 */\";","import { Component, OnInit } from \"@angular/core\";\r\nimport { FormGroup, FormControl, Validators } from \"@angular/forms\";\r\nimport { Router } from \"@angular/router\";\r\nimport { Storage } from \"@ionic/storage\";\r\nimport { LoginService } from \"./login.service\";\r\nimport { UsersService } from \"src/app/users/users.service\";\r\n\r\n@Component({\r\n  selector: \"app-form\",\r\n  templateUrl: \"./form.page.html\",\r\n  styleUrls: [\"./form.page.scss\"],\r\n})\r\nexport class FormPage implements OnInit {\r\n  public myForm: FormGroup;\r\n  public imageUrl: string;\r\n  public imageId: string;\r\n  constructor(\r\n    private loginService: LoginService,\r\n    private router: Router,\r\n    public storage: Storage,\r\n    private usersService: UsersService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.imageUrl = \"../../assets/logo/otoro-logo.png\";\r\n    this.imageId = \"top-image\";\r\n    this.myForm = new FormGroup({\r\n      email: new FormControl(\"email\", [Validators.required]),\r\n      password: new FormControl(\"password\", [Validators.required]),\r\n    });\r\n\r\n    this.myForm.controls[\"email\"].setValue(null);\r\n    this.myForm.controls[\"password\"].setValue(null);\r\n  }\r\n\r\n  public controlHasError(controlName: string, validationType: string): boolean {\r\n    const control = this.myForm.controls[controlName];\r\n    if (!control) {\r\n      return false;\r\n    }\r\n\r\n    const result =\r\n      control.hasError(validationType) && (control.dirty || control.touched);\r\n\r\n    return result;\r\n  }\r\n\r\n  login() {\r\n    let controls = this.myForm.controls;\r\n    if (this.myForm.invalid) {\r\n      Object.keys(controls).forEach((controlName) =>\r\n        controls[controlName].markAsTouched()\r\n      );\r\n      return;\r\n    }\r\n\r\n    const body = {\r\n      email: controls[\"email\"].value,\r\n      password: controls[\"password\"].value,\r\n    };\r\n\r\n    this.loginService\r\n      .run(body)\r\n      .toPromise()\r\n      .then(\r\n        async (res) => {\r\n          let result = res.json();\r\n          let deviceToken = await this.storage.get(\"deviceToken\");\r\n          this.storage.set(\"auth\", result);\r\n          let user = {\r\n            active: result.active,\r\n            deviceToken: deviceToken,\r\n            email: result.email,\r\n            id: result.id,\r\n            name: result.name,\r\n            roles: result.roles,\r\n          };\r\n          this.updateUser(user, result.token);\r\n        },\r\n        (err) => {\r\n          console.log(err);\r\n          let error = JSON.parse(err._body);\r\n          console.log(error);\r\n        }\r\n      );\r\n  }\r\n\r\n  updateUser(body: any, token: string) {\r\n    this.usersService\r\n      .update(body, token)\r\n      .toPromise()\r\n      .then(\r\n        async (res) => {\r\n          this.router.navigate([\"/dashboard\"]);\r\n        },\r\n        (err) => {\r\n          console.log(err);\r\n          let error = JSON.parse(err._body);\r\n          console.log(error);\r\n        }\r\n      );\r\n  }\r\n}\r\n","import { Injectable } from \"@angular/core\";\r\nimport { RestService } from \"src/app/core/services/rest.service\";\r\n\r\n@Injectable({\r\n  providedIn: \"root\",\r\n})\r\nexport class LoginService {\r\n  constructor(private service: RestService) {}\r\n\r\n  run(body) {\r\n    let url = `users/authenticate`;\r\n    return this.service.queryPostRegular(url, body);\r\n  }\r\n}\r\n","import { NgModule } from \"@angular/core\";\r\nimport { Routes, RouterModule } from \"@angular/router\";\r\nimport { FormPage } from \"./form/form.page\";\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: \"\",\r\n    component: FormPage,\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class LoginRoutingModule {}\r\n","import { NgModule } from \"@angular/core\";\r\nimport { CommonModule } from \"@angular/common\";\r\nimport { HttpClient, HttpClientModule } from \"@angular/common/http\";\r\nimport { FormsModule, ReactiveFormsModule } from \"@angular/forms\";\r\nimport { LoginRoutingModule } from \"./login-routing.module\";\r\nimport { SharedModule } from \"../shared/shared.module\";\r\nimport { IonicModule } from \"@ionic/angular\";\r\nimport { FormPage } from \"./form/form.page\";\r\nimport { DashboardPageModule } from \"../dashboard/dashboard.module\";\r\nimport { HTTP } from \"@ionic-native/http/ngx\";\r\nimport { IonicStorageModule } from '@ionic/storage';\r\n\r\n@NgModule({\r\n  imports: [\r\n    FormsModule,\r\n    HttpClientModule,\r\n    LoginRoutingModule,\r\n    IonicModule,\r\n    ReactiveFormsModule,\r\n    CommonModule,\r\n    SharedModule,\r\n    DashboardPageModule,\r\n    IonicStorageModule.forRoot(),\r\n  ],\r\n  declarations: [FormPage],\r\n  providers: [HTTP],\r\n})\r\nexport class LoginModule {}\r\n"],"sourceRoot":"webpack:///"}